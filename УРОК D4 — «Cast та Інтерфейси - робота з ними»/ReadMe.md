## Урок «Cast та Інтерфейси — робота з ними»

### Короткий опис
> Як «спілкуватися» між Blueprints без жорстких залежностей.  
> Після уроку ви навчитесь правильно **кастувати** об’єкти, створювати та викликати **Blueprint Interfaces**, а також побачите, коли касти взагалі не потрібні.

| Блок | Що вивчаємо | Практика |
| :- | :- | :- |
| **Casting Basics** | `Cast To <BP_Class>` node, `IsValid` | Отримуємо `BP_Player` із `OnHit` та викликаємо подію |
| **Blueprint Interface** | Створення BPI, `Implement Interface`, `Message` vs `Interface Call` | Робимо BPI `PlayerAction` та викликаємо функцію яка працює на різних акторах по різному|

---

### Q&A

| Питання | Відповідь |
| --- | --- |
| **Чому Cast падає в “Accessed None”?** | Об’єкт не існує / тип інший. Перевіряйте `IsValid` **до** касту або використовуйте `Cast Failed` Pin. |
| **Коли Cast краще за Interface?** | Коли 100 % знаєте клас (наприклад, Player Character) і треба доступ до **конкретних** функцій/змінних. |
| **Чому Message не виконується?** | Переконайтесь, що клас **реально** імплементує BPI і прапорець “Expose to Spawn” не порушує логіку створення. |
| **Чи реплікуються BPI виклики?** | Ні. Інтерфейс — лише локальний виклик. Для мережі заверніть виклик у Replicated Custom Event. |
| **Що швидше: Interface Call чи Cast?** | На практиці різниця мінімальна (< 0.01 мс). Важливіше — **кількість** викликів. Кешуйте посилання та не викликайте в Tick без потреби. |

---

### Лайфхаки та рекомендації

- **Single Responsibility:** одна BPI — одна «тема» (Interact, Damage, Health). Чіткі контракти → менше плутанини.  
- **Interface ↔ C++:** `TScriptInterface<IDamageable>` зберігає і UObject*, і вказівник на таблицю інтерфейсу. Уникає додаткових CastTo в C++.  
- **No-Tick Casting:** кастуйте раз у `BeginPlay`, збережіть у змінній `PlayerRef`.  
- **Interface в UI:** Widget не знає конкретного актора, просто викликає `UpdateAmmo(int)` через BPI.  
- **Soft Class Reference:** коли спавните клас із `SoftClassPtr`, каста не треба — уже знаєте тип.  
- **BlueprintPure Getter:** якщо вам лише потрібно читати дані з «чужого» об’єкта, створіть Pure Getter у BPI — менше Exec-ліній.

> Каст = швидкий доступ до **конкретного класу**; Інтерфейс = універсальне «запитання», неважливо, хто відповість.  
> Використовуйте каст один раз → кеш, у всіх інших випадках обирайте BPI та тримайте код вільним від зайвих залежностей.
